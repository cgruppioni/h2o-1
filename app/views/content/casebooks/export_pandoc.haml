%div.CasebookTitle{data: {'custom-style': 'Casebook Title'}}= @casebook.title
%div.CasebookSubtitle{data: {'custom-style': 'Casebook Subtitle'}}= @casebook.subtitle
%div.CasebookHeadnote{data: {'custom-style': 'Casebook Headnote'}}= @casebook.headnote

/ %table-of-contents
/   - @casebook.contents.each_with_index do |content, idx|
/     %toc-entry{data: {depth: content.ordinals.length, idx: idx + 1}}
/       = content.ordinal_string
/       = content.title

- @casebook.contents.each_with_index do |content, idx|
  - if content.is_a? Content::Section
    %div.SectionNumber{data: {'toc-idx': idx + 1, 'custom-style': 'Section Number'}}=content.ordinal_string
    %div.SectionTitle{data: {'custom-style': 'Section Title'}}=content.title
    - if content.subtitle.present?
      %div.SectionSubtitle{data: {'custom-style': 'Section Subtitle'}}=content.subtitle
    - if content.headnote.present?
      %div.SectionHeadnote{data: {'custom-style': 'Section Headnote'}}= content.headnote
  - elsif content.is_a? Content::Resource
    %div.ResourceNumber{data: {'toc-idx': idx + 1, 'custom-style': 'Resource Number'}}=content.ordinal_string
    %div.ResourceTitle{data: {'custom-style': 'Resource Title'}}=content.title
    - if content.subtitle.present?
      %div.ResourceSubtitle{data: {'custom-style': 'Resource Subtitle'}}= content.subtitle
    - if content.headnote.present?
      %div.ResourceHeadnote{data: {'custom-style': 'Resource Headnote'}}= content.headnote
    - if content.resource.class.in? [Case, TextBlock]
      %div.opinion
        - content.send(@include_annotations ? :annotated_paragraphs : :paragraph_nodes).each do |node|
          = node.to_html.html_safe
        - if @include_annotations
          %div= content.footnote_annotations
    - elsif content.resource.is_a? Default
      %div{data: {'custom-style': 'Resource Link'}}
        = link_to content.resource.url, content.resource.url, target: '_blank'
